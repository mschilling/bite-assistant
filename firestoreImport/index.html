<html>

<head>
  <title>Page Title</title>
  <script src="stores.js"></script>
  <script src="users.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.6.0/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.6.0/firebase-firestore.js"></script>
</head>

<body>

  <script>

    /*
    Run this code to update the restaurants and users table.
    You'll need to export a JSON file from the firebase database
    then select the user/store part and paste it in the users/stores JSON files.
    Or simply update the information manually in the JSON files.
    */

    firebase.initializeApp({
      apiKey: 'YOUR_API_KEY',
      authDomain: 'bite-4ce99.firebaseapp.com',
      projectId: 'bite-4ce99'
    });

    // Initialize Cloud Firestore through Firebase
    var db = firebase.firestore();

    //IMPORT ALL STORES AND THE ITEMS IN IT FROM A JSON FILE
    var content = STORES;
    console.log(content);
    content &&
      //contentKey = _seed
      Object.keys(content).forEach(contentKey => {
        const nestedContent = content[contentKey];
        if (typeof nestedContent === "object") {
          //docTitle = Restaurants
          Object.keys(nestedContent).forEach(docTitle => {
            const nestedContent1 = nestedContent[docTitle];
            console.log(nestedContent1); //single object
            if (typeof nestedContent1 === "object") {
              //title = 1/2/3
              Object.keys(nestedContent1).forEach(title => {
                const nestedContent2 = nestedContent1[title];
                console.log(nestedContent2); //single item
                let restaurant = {
                  id: nestedContent1[title].id,
                  location: nestedContent1[title].loaction,
                  name: nestedContent1[title].name,
                }
                if (typeof nestedContent1[title].products === "object") {
                  Object.values(nestedContent1[title].products).forEach((product) => {
                    firebase.firestore().collection(docTitle).doc(title).collection("products").add(product);
                  })
                }
                firebase.firestore().collection(docTitle).doc(title).set({
                  id: nestedContent1[title].id,
                  location: nestedContent1[title].location,
                  name: nestedContent1[title].name,
                });
              });
            }
          });
        }
      });

    //IMPORT ALL USERS AND THEIR INFO FROM A JSON FILE
    content = USERS;
    content &&
      Object.keys(content).forEach(contentKey => {
        const nestedContent = content[contentKey];
        if (typeof nestedContent === "object") {
          Object.keys(nestedContent).forEach(docTitle => {
            firebase
              .firestore()
              .collection(contentKey)
              .doc(docTitle)
              .set(nestedContent[docTitle]);
          });
        }
      });

  </script>>

</body>

</html>